# Инструкция для мобильного приложения Trade-agents

## 1. Подключение

После выполнения установки приложения необходимо на рабочем столе кликнуть по иконке:

![alt text](img/1.Connection/1.Icon.png)​

В стартовом экране есть возможность выбрать режим подключения:
- Демо режим
- Подключение к серверу

<img src="img/1.Connection/1.StartScreen.jpg" alt="drawing" height="600"/>

При нажатии на кнопку **Подключиться в демо** выполняется автоматический вход в приложение под тестовым пользователем. 
В данном режиме можно ознакомиться с функционалом приложения offline и без подключения к базе данных.

Загрузка данных и работа в приложении пояснена далее в пунктах 2-8.

Выйти из демо режима можно, открыв боковую панель нажатием на иконку меню, находящуюся в верхнем углу приложения слева, или смахнув пальцем вправо с левого края устройства. Затем перейти на экран **Профиль** и нажать на кнопку **Выйти из демо режима**.

Чтобы подключиться к рабочей базе данных необходимо выбрать **Подключиться к серверу** для перехода на экран настройки параметров сервера. 

<img src="img/1.Connection/1.ConnectionSettings.jpg" alt="drawing" height="600"/>

В этом экране следует указать следующие параметры:
- Адрес сервера
- Порт

Поле **ID устройства** будет заполнено автоматически после завершения аутентификации.

При нажатии на кнопку **Сохранить** переходим к окну для подключения к серверу

<img src="img/1.Connection/1.Connection.jpg" alt="drawing" height="600"/>

Нажимаем кнопку **Подключиться**.

Если приложение подключилось к серверу успешно, то появится экран **Активация устройства**. 
В данном экране необходимо ввести код активации, который пользователь должен получить от администратора системы, и нажать **Отправить**. 
При последующих запусках приложения будет происходить автоматический вход в учетную запись пользователя.

По нажатию на иконку в правом нижнем углу можно перейти на экран подключения к серверу.

<img src="img/1.Connection/1.Activation.jpg" alt="drawing" height="600"/> <img src="img/1.Connection/1.ActivationCode.jpg" alt="drawing" height="600"/>

Если активация устройства прошла успешно, появится экран для входа пользователя. В соответствующие поля необходимо ввести **Имя пользователя** и **Пароль** и нажать на кнопку **Войти**. 

<img src="img/1.Connection/1.Login.jpg" alt="drawing" height="600"/> <img src="img/1.Connection/1.LoginUser.jpg" alt="drawing" height="600"/>

При успешном выполнении входа попадаем на главный экран -- **Маршруты**.

Чтобы загрузить необходимые данные следует нажать на иконку вызова меню **≡**, находящуюся в верхнем левом углу приложения:

<img src="img/1.Connection/1.Sidebar.jpg" alt="drawing" height="600"/>

Далее нажать на иконку загрузки данных слева в нижнем углу меню:

![alt text](img/1.Connection/1.Sync.jpg)​

После загрузки данных в разделе **Справочники** отобразятся все актуальные справочники, а в экране **Маршруты** появятся документы маршрутов для текущего пользователя. В разделе **Карты** можно просмотреть информацию по текущему маршруту на карте или в виде списка.

## 2. Справочники

Экран **Справочники** содержит информацию о справочниках, необходимых для работы с приложением.

<img src="img/2.References/2.References.jpg" alt="drawing" height="600"/>

При нажатии на конкретный справочник переходим на экран просмотра:

<img src="img/2.References/2.Goods.jpg" alt="drawing" height="600"/>

По нажатию на позицию из списка можно перейти в окно просмотра позиции:

<img src="img/2.References/2.GoodPosition.jpg" alt="drawing" height="600"/>

Пример справочника магазинов:

<img src="img/2.References/2.Outlets.jpg" alt="drawing" height="600"/> <img src="img/2.References/2.OutletPosition.jpg" alt="drawing" height="600"/>

Для поиска конкретного справочника по наименованию можно воспользоваться окном для поиска в правом верхнем углу экрана.

## 3. Заявки

Документы сгруппированы следующим образом:

| Группа | Описание                                                                                                                                                                    |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Активные        | Данные документы являются необработанными, либо обработанными, но не синхронизированными с Гедымином.                                                                    |
| Архив           | Данные документы являются обработанными и отправленными в Гедымин, на них получено обратное сообщение о синхронизации. Не подлежат редактированию, возможен только просмотр |
| Все             | Активные документы и документы из архива                                                                                                                                    |

Перейдем на экран заявок.

<img src="img/3.Orders/3.Orders.jpg" alt="drawing" height="600"/>

По нажатию на иконку **+** в верхнем правом углу переходим в окно добавления заявки. Каждое поле является обязательным для заполнения.

<img src="img/3.Orders/3.OrderAdd.jpg" alt="drawing" height="600"/>

При выборе **Организации** и **Магазина** попадаем в экран выбора организаций и магазина. Поле **Магазин** следует заполнять только после выбора организации. Поле **Склад магазин** при наличии настроек пользователя заполняется автоматически (данные настройки будут рассмотрены в экране **Профиль**). Если данное поле не заполнено, следует выбрать необходимый склад.

<img src="img/3.Orders/3.Contacts.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.Outlets.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.Departs.jpg" alt="drawing" height="600"/>

Для добавления заявки необходимо нажать на иконку **✓** в правом верхнем углу.

<img src="img/3.Orders/3.OrderNew.jpg" alt="drawing" height="600"/>

После добавления сразу попадаем в экран просмотра заявки. По нажатию на кнопку меню, расположенную в правом верхнем углу становятся доступны следующие функции: **Добавить товар**, **Редактировать данные**, **Удалить заявку**. Добавить товар также можно по иконке **+**. Редактировать данные заявки можно нажав на саму заявку, доступную для редактирования (розовый или зеленый цвет).

<img src="img/3.Orders/3.OrderView.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.ViewMenu.jpg" alt="drawing" height="600"/>

У каждой заявки (и далее у возвратов) есть свой цвет иконки или боковой полосы, который отображает состояние заявки. При смене состояния заявки меняется и цвет.

| Цвет    | Описание состояния                         |
| ------- | ------------------------------------------ |
| Розовый | Заявка существует                          |
| Зеленый | Заявка обрабатывается                      |
| Желтый  | Заявка отправлена, ожидается подтверждение |
| Синий   | Заявка архивирована                        |

В заявку есть возможность добавить товар.

По нажатию на иконку **+** в верхнем правом углу переходим в экран добавления товаров. На экране отображены **Группы ТМЦ**.

<img src="img/3.Orders/3.GroupOne.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.GroupTwo.jpg" alt="drawing" height="600"/>

По выбору нужной категории переходим в **Товары**, нажимаем на необходимый товар и попадаем на экран с позициями. **Наименование** и **Цена** заполнены автоматически и изменению не подлежат. **Количество мест** обязательно для заполнения, **Упаковка** заполняется только при наличии предложенных вариантов.

<img src="img/3.Orders/3.GoodsOne.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.PositionOne.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.GoodPositionOne.jpg" alt="drawing" height="600"/>

Добавим еще один товар.

<img src="img/3.Orders/3.GoodsTwo.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.PositionTwo.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.GoodPositionTwo.jpg" alt="drawing" height="600"/>

Вернемся на экран просмотра заявки.

<img src="img/3.Orders/3.OrderViewGood.jpg" alt="drawing" height="600"/>

По умолчанию у заявки статус **Черновик**. Изменить статус можно в экране редактирования. Для этого нужно нажать на заявку, изменить статус и сохранить заявку. При изменении статуса завка переходит в состояние **Обрабатывается**, цвет становится зеленым.

<img src="img/3.Orders/3.OrderEditDraft.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.OrderEditReady.jpg" alt="drawing" height="600"/> <img src="img/3.Orders/3.OrderViewReady.jpg" alt="drawing" height="600"/>

Пока заявка не отправлена, она доступна для редактирования. Для этого нужно зайти в нее и временно вернуть статус **Черновик**. После отправления заявки редактирование невозможно, цвет становится желтым.

Вернемся на экран просмотра всех заявок.

<img src="img/3.Orders/3.OrdersReady.jpg" alt="drawing" height="600"/>

Для отправления заявки необходимо нажать на кнопку синхронизации, расположенную в боковом меню.

<img src="img/3.Orders/3.OrdersSent.jpg" alt="drawing" height="600"/>

При получении подтверждения заявка переходит в архив, цвет становится синим. При наличии ошибки в заявке появится надпись **Отказано** и вид ошибки.

Если смахнуть заявку влево, то появится меню в дополнительными иконками.

<img src="img/3.Orders/3.Swipe.jpg" alt="drawing" height="600"/>

Данное меню позволяет редактировать заявку (если она является доступной для редактирования), копировать заявку и удалить.

## 4. Возвраты

Перейдем на экран возвратов.

<img src="img/4.Returns/4.Returns.jpg" alt="drawing" height="600"/>

По нажатию на иконку **+** в верхнем правом углу переходим в окно добавления возврата. Каждое поле является обязательным для заполнения.

<img src="img/4.Returns/4.ReturnAdd.jpg" alt="drawing" height="600"/>

При выборе **Организации** и **Магазина** попадаем в экран выбора организаций и магазина. Поле **Магазин** следует заполнять только после выбора организации.

<img src="img/4.Returns/4.Contacts.jpg" alt="drawing" height="600"/> <img src="img/4.Returns/4.Outlets.jpg" alt="drawing" height="600"/>

Для добавления заявки необходимо нажать на иконку **✓** в правом верхнем углу.

После добавления сразу попадаем в экран просмотра возврата. По нажатию на кнопку меню, расположенную в правом верхнем углу становятся доступны следующие функции: **Добавить товар из накладной**, **Редактировать данные**, **Удалить возврат**. Редактировать данные возврата можно нажав на сам возврат, доступный для редактирования (полоса розового или зеленого цвета), открывается экран редактирования.

<img src="img/4.Returns/4.ReturnView.jpg" alt="drawing" height="600"/> <img src="img/4.Returns/4.ViewMenu.jpg" alt="drawing" height="600"/>

В отличии от заявок, в возврат есть возможность добавить товар только из накладной.

По нажатию на иконку **+** в верхнем правом углу переходим в экран поиска товаров из накладной. Указываем даты начала и окончания, и выбираем нужный товар.

<img src="img/4.Returns/4.ReturnSellBill.jpg" alt="drawing" height="600"/> <img src="img/4.Returns/4.ReturnSellBillAdd.jpg" alt="drawing" height="600"/>

После завершения поиска отобразится список накладных.

<img src="img/4.Returns/4.SellBills.jpg" alt="drawing" height="600"/>

Если накладные не были найдены, на экран выведется надпись **Накладные не найдены**.

Если произошла ошибка подключения к серверу с данными, в нижней части экрана отобразится ошибка.

![alt text](img/4.Returns/4.Error.png)​

Заходим в нужную накладную и попадаем на экран со списком позиций. Для редактирования доступно поле **Количество**. Нельзя укзатаь количество, больше чем из накладной. Указываем нужное количество и добавляем.

<img src="img/4.Returns/4.Position.jpg" alt="drawing" height="600"/> <img src="img/4.Returns/4.PositionError.jpg" alt="drawing" height="600"/> <img src="img/4.Returns/4.PositionGood.jpg" alt="drawing" height="600"/>

После добавления попадаем в экран просмотра накладной.

<img src="img/4.Returns/4.ReturnViewSellBill.jpg" alt="drawing" height="600"/>

По умолчанию у возврата статус **Черновик**. Изменить статус можно в экране редактирования. Для этого нужно нажать на возврат. При изменении статуса возврат переходит в состояние **Обрабатывается**, цвет полосы становится зеленым.

<img src="img/4.Returns/4.ReturnEditDraft.jpg" alt="drawing" height="600"/> <img src="img/4.Returns/4.ReturnEditReady.jpg" alt="drawing" height="600"/> <img src="img/4.Returns/4.ReturnViewReady.jpg" alt="drawing" height="600"/>

Пока возврат не отправлен, он доступен для редактирования. Для этого нужно зайти в него и временно вернуть статус **Черновик**. После отправления возврата редактирование невозможно, цвет полосы становится желтым.

Вернемся на экран просмотра всех заявок.

<img src="img/4.Returns/4.ReturnsReady.jpg" alt="drawing" height="600"/>

Для отправления заявки необходимо нажать на кнопку синхронизации, расположенную в боковом меню.

<img src="img/4.Returns/4.ReturnsSent.jpg" alt="drawing" height="600"/>

При получении подтверждения возврат переходит в архив, цвет полосы становится синим. При наличии ошибки в возврате появится надпись **Отказано** и вид ошибки.

Если смахнуть возврат влево, то появится меню в дополнительными иконками.

<img src="img/4.Returns/4.Swipe.jpg" alt="drawing" height="600"/>

Данное меню позволяет редактировать возврат (если он является доступным для редактирования), копировать возврат и удалить.

## 5. Маршруты

Перейдем на экран **Маршруты**.

Документы сгруппированы следующим образом:

| Группа | Описание                                                                                                                                                                    |
| --------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Активные        | Документы, дата которых не менее текущей даты.                                                                     |
| Архив           | Документы, дата которых меньше текущей даты. |
| Все             | Все документы                                                                                                                            |

<img src="img/5.Routes/5.Routes.jpg" alt="drawing" height="600"/>

При выборе (нажатием на строку) необходимого маршрута откроется экран с торговыми точками, запланированными для посещения.

<img src="img/5.Routes/5.Route.jpg" alt="drawing" height="600"/>

После нажатия на торговую точку откроется экран с визитом выбранного объекта.

<img src="img/5.Routes/5.Visit.jpg" alt="drawing" height="600"/>

Нажимаем на кнопку **Начать визит** (в этот момент один раз телефон попросит разрешение на получение геокоординаты, которая будет записана в визит данной точки).

<img src="img/5.Routes/5.VisitStart.jpg" alt="drawing" height="600"/>

Из экрана визита пользователь имеет возможность создать доступные в визите документы - заявку и возврат). Для создания заявки нажимаем на кнопку **Добавить документ** и выбираем тип документа **Заявка**.

<img src="img/5.Routes/5.TypeOrder.jpg" alt="drawing" height="600"/>

После выбора добавления заявки откроется экран с информацией об объекте и списком товаров (если уже были добавлены). Нажав на информацию о точке можно изменить доступное поле - дата отгрузки заявки.

<img src="img/5.Routes/5.OrderView.jpg" alt="drawing" height="600"/> <img src="img/5.Routes/5.OrderEdit.jpg" alt="drawing" height="600"/>

Добавим товар.

<img src="img/5.Routes/5.Group.jpg" alt="drawing" height="600"/> <img src="img/5.Routes/5.OrderPosition.jpg" alt="drawing" height="600"/> <img src="img/5.Routes/5.OrderGood.jpg" alt="drawing" height="600"/>

Аналогично создаем документ возврата. Для создания нажимаем на кнопку **Добавить документ** и выбираем тип документа **Возврат**.

<img src="img/5.Routes/5.TypeReturn.jpg" alt="drawing" height="600"/>

После выбора добавления возврата откроется экран с информацией об объекте и списком товаров из накладных (если уже были добавлены). Нажав на информацию о точке можно зайти в окно просмотра документа возврата, изменение документ не подлежит.

<img src="img/5.Routes/5.OrderView.jpg" alt="drawing" height="600"/> <img src="img/5.Routes/5.OrderEdit.jpg" alt="drawing" height="600"/>

Добавим товар из накладной.

<img src="img/5.Routes/5.SellBillSearch.jpg" alt="drawing" height="600"/> <img src="img/5.Routes/5.SellBills.jpg" alt="drawing" height="600"/>

<img src="img/5.Routes/5.SellBillPosition.jpg" alt="drawing" height="600"/> <img src="img/5.Routes/5.ReturnSellBill.jpg" alt="drawing" height="600"/>

После создания необходимых документов завершаем визит нажатием на кнопку **Завершить визит**.

<img src="img/5.Routes/5.VisitOrderReturn.jpg" alt="drawing" height="600"/> <img src="img/5.Routes/5.VisitEnd.jpg" alt="drawing" height="600"/>

Отправим данные визита нажатием на кнопку **Отправить**.

<img src="img/5.Routes/5.VisitSent.jpg" alt="drawing" height="600"/>

Данный визит в списке всех визитов отобразится как завершенный (кружок с галочкой). Активный визит обозначается кружком с треугольником.

<img src="img/5.Routes/5.RouteVisit.jpg" alt="drawing" height="600"/>

Заявки и возвраты из визитов отображаются в окнах **Заявки** и **Возвраты**.

<img src="img/5.Routes/5.OrdersVisit.jpg" alt="drawing" height="600"/> <img src="img/5.Routes/5.ReturnsVisit.jpg" alt="drawing" height="600"/>

## 6. Карта

На экране **Карта** представлены две вкладки, содержащие информацию по выбранному маршруту.

<img src="img/6.Maps/6.Map.jpg" alt="drawing" height="600"/> <img src="img/6.Maps/6.List.jpg" alt="drawing" height="600"/>

Во кладке **Список** показаны все точки маршрута в виде списка.

Во кладке **Карта** полностью отображены все точки маршрута на карте. Кнопками < и > можно приближаясь к точкам перемещаться между объектами. Так же кнопками можно получить свою текущую координату и отобразить все объекты на экране.

В верхней части экрана указано название маршрута, который в данный момент отображается на карте. Для смены маршрута необходимо нажать на название, после чего в нижней части экрана появится окно с выбором маршрута. Выберем второй маршрут.

<img src="img/6.Maps/6.MapRoutes.jpg" alt="drawing" height="600"/> <img src="img/6.Maps/6.NewRoute.jpg" alt="drawing" height="600"/>

При нажатии на точку маршрута изменится цвет данной точки, появится название возле точки и в верхней части экрана. Также во вкладке **Список** отбразится, что данная точка выбрана.

<img src="img/6.Maps/6.MapPoint.jpg" alt="drawing" height="600"/> <img src="img/6.Maps/6.ListPoint.jpg" alt="drawing" height="600"/>

Выберем во вкладке **Список** другую точку и посмотрим ее отображение на карте.

<img src="img/6.Maps/6.NewMapPoint.jpg" alt="drawing" height="600"/> <img src="img/6.Maps/6.NewListPoint.jpg" alt="drawing" height="600"/>

## 7. Матрицы

<img src="img/7.Matrix/7.Contacts.jpg" alt="drawing" height="600"/> <img src="img/7.Matrix/7.Goods.jpg" alt="drawing" height="600"/> <img src="img/7.Matrix/7.Position.jpg" alt="drawing" height="600"/>

## 8. Настройки

Экран **Настройки** содержит информацию о настройках устройства: о параметрах связи с сервером и о настройках приложения. Настройки приложения доступны для изменения пользователем. По умолчанию в Настройках приложения есть следующие поля: **Перезаписывать справочники**, **Время хранения документов в архиве**. При наличии частных настроек добавляются поля **Использовать матрицы**, **Бэк-Офис. Адрес сервера**, **Бэк-Офис. Порт сервера**, **Время ожидания**, **Время поиска накладных возврата**. По нажатию на иконку меню, расположенную в правом верхнем углу, можно вернуться к начальным настройка, выбрав пункт **Установить настройки по умолчанию**.

<img src="img/8.Settings/8.BaseSettings.jpg" alt="drawing" height="600"/> <img src="img/8.Settings/8.Settings.jpg" alt="drawing" height="600"/> <img src="img/8.Settings/8.SettingsMenu.jpg" alt="drawing" height="600"/>

## 9. Профиль

Экран **Профиль** содержит информацию о пользователе и об устройстве. Также здесь можно выйти из учетной записи пользователя. При наличии настроек пользователя, они также будут отображены в данном экране.

<img src="img/9.Profile/9.Profile.jpg" alt="drawing" height="600"/> <img src="img/9.Profile/9.ProfileSettings.jpg" alt="drawing" height="600"/>

Если вход был произведен в демо режиме, кнопка **Сменить пользователя** меняется на **Выйти из демо режима**

<img src="img/9.Profile/9.ProfileDemo.jpg" alt="drawing" height="600"/>

Также этот экран позволяет очистить данные пользователя. Для этого необходимо нажать на иконку меню, расположенную в правом верхнем углу, и выбрать пункт **Очистить данные**.

<img src="img/9.Profile/9.ClearData.jpg" alt="drawing" height="600"/>
